<div class="chart-wrapper">
   <div class="dataset-tabs">
      <span
         class="dataset-tab-item"
         *ngFor="let dataset of datasets; let datasetIdx = index"
         [ngClass]="currentIndex === datasetIdx ? 'dataset-tab-item-active' : ''"
         (click)="changeDatasetTab(datasetIdx)"
         >{{ dataset?.datasetName }}
         <button mat-icon-button (click)="closeDatasetTab(datasetIdx); $event.stopPropagation()">
            <mat-icon style="font-size: 1rem">close</mat-icon>
         </button>
      </span>
      <button mat-icon-button color="primary" (click)="createNewDatasetTab()">
         <mat-icon style="font-size: 1.75rem; margin-bottom: 5px">add</mat-icon>
      </button>
      <div class="tab-color-fill"></div>
   </div>
   <app-chart-control
      [dataset]="datasets[currentIndex]"
      [requestSnapsotSubject]="requestSnapshotSubject"
      (datasetSnapshot)="modifyDataset($event)"
      (chartInit)="handleChartCreation($event)"
   ></app-chart-control>
   <div
      id="chartContainer"
      appChartContainer
      [datasets]="datasets"
      [controlSignal]="chartControlsSubject"
      (accessContainer)="setContainer($event)"
      appScrollIntoView
      [scrollSignal]="scrollSignal"
   ></div>
   <div class="download-chart" *ngIf="init">
      <button type="button" mat-fab color="primary" matTooltip matTooltipPosition="before" (click)="downloadCanvas()">
         <mat-icon>download</mat-icon>
      </button>
   </div>
   <div class="download-options-backdrop" *ngIf="showUserConfirmDialog">
      <div class="download-modal">
         <mat-card>
            <mat-card-title> Download your chart </mat-card-title>
            <mat-card-content>
               <h3>Name of the Chart</h3>
               <mat-form-field>
                  <input #fileName type="text" matInput [value]="chartOptions.title" />
               </mat-form-field>
            </mat-card-content>
            <mat-card-actions>
               <button mat-raised-button (click)="handleUserActionOnDownload(true, fileName.value)">Confirm</button>
               <button mat-raised-button (click)="handleUserActionOnDownload(false)">Cancel</button>
            </mat-card-actions>
         </mat-card>
      </div>
   </div>
</div>
